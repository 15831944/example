# 白話機器學習-最大似然

機器學習，從本質上講，就是一種經驗的總結。

例如，「山雨欲來風滿樓」，山裡面下大雨之前會颳大風，就是一種經驗的總結。當然，這也不是100%準確的事情，只是從機率上看，颳風之後下雨的可能性是最大的。

機器學習模型，我們追求的也就是，這個模型看上去是最靠譜的，最接近我們觀察到的事實的。換句話說，我們通過觀察到的事件，來確定模型，使得這個模型在機率上說，是最有可能的，最符合我們觀察到的事件的。

## 不均勻硬幣

現在，有一枚硬幣，由於加工不均勻，每次拋硬幣時，其正面朝上的機率為 X ，現在，我們怎麼才能知道這個X是多少呢？最簡單的辦法是拋10次硬幣，如果6次正面朝上，我們很容易脫口而出，正面朝上的機率是3/5.

為什麼我們可以脫口而出，不假思索的說是3/5呢？理由很簡單啊，拋10次，6次向上，正面朝上的機率為3/5最合理啊，這種可能性最高啊。

由於是機率，所以，這個估計或多或少都存在一個運氣的問題，可能這個硬幣朝上的機率只有1/10,但是拋硬幣的人特別妖，就是能夠10次裡面拋出6次正面朝上。

「拋10次硬幣，6次正面向上「 和 」硬幣正面朝上的機率為3/5」

「拋10次硬幣，6次正面向上「 和 」硬幣正面朝上的機率為1/10」

由於拋硬幣問題簡單，而且上面兩個判斷相差很大，所以我們很容易就知道前者可能性最大，後者可能性較小。如果問題改成

山雨欲來風滿樓

雨後出現彩虹

哪個比較靠譜，這個就非常難了吧。所以，我們還需要一套理論去量化靠譜程度，可能性到底有多高的程度。

## 獵人

MLE（maximum likelihood estimation）的最本質的思想就是：發生某事件X，我們非常關心導致這件事情發生的原因或者細節A(A有多種可能性)。但對於A，我們無法溯源去回放事件，去驗證到底是哪個。於是我們企圖找到某一個A(即估計值Ahat)，使得【基於Ahat，當下我們觀察到的現實——X的發生——具有最大的發生的可能性】，這樣的想法得到的Ahat就是極大似然估計。一個小故事：有一個業餘的獵人新手和一名資深獵人，他們一人一把槍地跑去打獵，砰地一聲槍響，一頭小鹿應聲倒地，這時候問你：更可能的情況是獵人打中了還是新手打中了？在這個故事裡，【發生的某事件X】是小鹿被打中，【我們關心的事情A】是誰打中了小鹿，【A的可能的情況】有獵人打中或新手打中，【極大似然估計A】是獵人打中。

## 機率分布

1. 機率密度函數

假如我們要預測明天的下雨量，x表示下雨的量，f(x)就表示為機率密度

其中機率密度函數f(x)並不代表機率，只是代表當前x點的機率密度，類似於速度不代表位移一樣，我們把所有可能發生事件機率相加應該為1。

`∫+∞−∞f(x)dx=1`

其中f(x)>=0，也可以計算下雨量在某個範圍內的機率：

`P(a<x<b)=∫abf(x)dx=1`

積分後的機率即成為機率分布。

2. 二項分布

拋硬幣是典型的二線分布，假設我們拋了5次硬幣，設定P(x)表示有x次硬幣正面朝上的話。

其中x為正面朝上的次數，離散變量和連續變量的差別可以看下面的泊松分布。

3. 泊松分布

泊松分布是二項分布的極限情況。

假設我們現在要估計某個路口一小時經過k輛車的機率，第一步我們需要先大量的觀察一段時間，獲得一個一小時內通過汽車數量的期望λ。

然後我們把一小時分為60分鐘，同時假設每一分鐘要麼經過一輛車，要麼沒有車，那麼按照二項分布的式子：

`P(k)=Ck60(λ60)k(1−λ60)60−k`

也就是說，期望除以60分鐘（把一小時分成60份）獲得每一分鐘有一輛車經過的機率。

但是很明顯我們不能確保每分鐘真的只過一輛，為了更加精確，我們可以把一小時繼續分為3600秒或72000個半秒，也就是說分的越多份，越精確。如果我們這麼一直分下去，我們就獲得了泊松分布，也就是二項分布的極限情況。

如果引入極限和e，泊松分布可以表達為(參考這裡)：

`P(X=k)=e−λλkk!`

4. 正態分布

跟泊松分布一樣，正態分布其實也是在大量觀察現實世界的接觸上總結推理出來的，它的機率密度函數為：

`f(x)=12π−−√σe−(x−μ)22σ2`

其中μ為觀察到的數據的均值，是期望的一種估計方式，類似上面泊松分布估計用的期望,在圖上表示為中心點的位置。

σ是樣本的標準差，在圖上可以表現為向中央的緊縮程度。

正態分布的特點是大自然中很多事件都符合它的描述，比如20歲男子的身高、同一個學校里學生的成績分布等等。

正態分布還有一個有趣的特點是：

- 橫軸區間（μ-σ，μ+σ）內的面積(即機率)為68.268949%
- 橫軸區間（μ-1.96σ，μ+1.96σ）內的面積為95.449974%
- 橫軸區間（μ-2.58σ，μ+2.58σ）內的面積為99.730020%

正態分布可以通過調整其兩個參數能夠擬合很多自然界的情況，也可以和其他分布在某些情況下互相轉換。

5. Gamma分布

正態分布的特點是左右對稱，這個世界也有很多不符合這種分布的情況，比如某個事件的熱度，可能會先迅速上升，然後緩慢降低熱度，還有發射火箭的速度等等。

從物理意義上說，Gamma分布表示第α件事情發生時所需等待的時間. b表示某事件發生需要的時間

Gamma(a,b)表示第α件事情發生時所需等待的時間。

6. 伯努利、二項分布、多項分布

伯努利分布就是對單次拋硬幣的建模，X~Bernoulli(p)的PDF為f(x)=px(1−p)1−x，隨機變量X只能取{0, 1}。對於所有的pdf，都要歸一化！而這裡對於伯努利分布，已經天然歸一化了，因此歸一化參數就是1。

很多次拋硬幣的建模就是二項分布了。注意二項分布有兩個參數，n和p，要考慮拋的次數。

二項式分布是拋多次硬幣，出現n次正面的機率，其機率密度函數圖，就是直方圖
多項式分布就是拋一個多面體，每個面朝上的機率為pi, 所以p1+p2+...+pk=1, 拋一次的結果是(x11,x12,x13,...,x1k)注意只有一個x1i=1，其他都為0

那麼拋n次多面體，就是多項式分布，其中xi表示i面朝上一共出現了xi次

二項分布的典型例子是扔硬幣，硬幣正面朝上機率為p, 重複扔n次硬幣，k次為正面的機率即為一個二項分布機率。

硬幣正面向上機率是0.6，拋10次，6次朝上的機率是 0.2508

硬幣正面向上機率是0.1，拋10次，6次朝上的機率是 0.0001

（順便計算一下，硬幣正面向上機率是0.1，拋10次，1次朝上的機率是 0.3874）

無論硬幣正面向上機率是多少，如果將拋10次裡面1次朝上的機率，2次朝上的機率，一直累加到10次朝上的機率，其總和應該為1.

我們看到10次裡面6次朝上的結果，硬幣正面向上機率為0.6和0.1之間相差上千倍。

硬幣正面向上機率是0.1，拋10次，1次朝上「 比 」硬幣正面向上機率是0.6，拋10次，6次朝上更加靠譜

機率分布就是為了量化靠譜程度的數學工具。通過這些工具，我們可以計算出一個觀察結果（拋10次硬幣，6次正面向上）和一個帶參數（正面朝上機率）的模型之間，從機率上講，相似（似然）程度。
